
- general code review and cleanup

Cc: NeilBrown <neil@brown.name>
